---
#this play creates the directories required for deploying the rack application and copies the files for the simple sinatra application


- name: Create the directories for deploying the rack application, if not present
  file: name=/var/www/{{ item }} state=directory owner=root group=root mode=0755
  with_items:
      - simple-sinatra-app
      - simple-sinatra-app/tmp
      - simple-sinatra-app/public

- name: Create the vhosts.conf file using the template and copy it to the sites available 
  template: src=vhosts.conf.j2 dest=/etc/apache2/sites-available/vhosts.conf owner=root group=root mode=0644

- name: Enable apache2 site and restart apache
  command: /usr/sbin/a2ensite vhosts.conf
  notify: restart apache
